(window.webpackJsonp=window.webpackJsonp||[]).push([[48],{549:function(a,e,t){"use strict";t.r(e);var s=t(4),r=Object(s.a)({},(function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("h2",{attrs:{id:"环境安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#环境安装"}},[a._v("#")]),a._v(" 环境安装")]),a._v(" "),t("ol",[t("li",[a._v("安装VM virtualBox")]),a._v(" "),t("li",[a._v("安装vagrant")])]),a._v(" "),t("h4",{attrs:{id:"安装vagrant"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装vagrant"}},[a._v("#")]),a._v(" 安装vagrant")]),a._v(" "),t("ol",[t("li",[t("p",[a._v("安装Centos7")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("vagrant init centos/7\n")])])])]),a._v(" "),t("li",[t("p",[a._v("启动Centos7")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("vagrant up\n")])])])]),a._v(" "),t("li",[t("p",[a._v("连接到Centos")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("vagrant ssh\n")])])])]),a._v(" "),t("li",[t("p",[a._v("通过Vagrantfile配置固定IP")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v('config.vm.network "private_network", ip: "192.168.56.10"\n')])])])]),a._v(" "),t("li",[t("p",[a._v("重启vagrant")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("vagrant reload\n")])])])])]),a._v(" "),t("h4",{attrs:{id:"安装docker"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装docker"}},[a._v("#")]),a._v(" 安装docker")]),a._v(" "),t("ol",[t("li",[t("p",[a._v("删除旧版本")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("sudo yum remove docker \\\n                  docker-client \\\n                  docker-client-latest \\\n                  docker-common \\\n                  docker-latest \\\n                  docker-latest-logrotate \\\n                  docker-logrotate \\\n                  docker-engine\n")])])])]),a._v(" "),t("li",[t("p",[a._v("安装")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("sudo yum install -y yum-utils\n\nsudo yum-config-manager \\\n    --add-repo \\\n    https://download.docker.com/linux/centos/docker-ce.repo\n")])])])]),a._v(" "),t("li",[t("p",[a._v("安装docker引擎")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("sudo yum install docker-ce docker-ce-cli containerd.io\n")])])])]),a._v(" "),t("li",[t("p",[a._v("启动docker")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("sudo systemctl start docker\n")])])])]),a._v(" "),t("li",[t("p",[a._v("设置开机自启动")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("sudo systemctl enable docker\n")])])])]),a._v(" "),t("li",[t("p",[a._v("配置镜像加速器")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v('sudo mkdir -p /etc/docker\nsudo tee /etc/docker/daemon.json <<-\'EOF\'\n{\n  "registry-mirrors": ["https://dkcvnb0h.mirror.aliyuncs.com"]\n}\nEOF\nsudo systemctl daemon-reload\nsudo systemctl restart docker\n')])])])])]),a._v(" "),t("h4",{attrs:{id:"安装mysql"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装mysql"}},[a._v("#")]),a._v(" 安装mysql")]),a._v(" "),t("ol",[t("li",[t("p",[a._v("下载mysql镜像")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("sudo docker mysql:5.7\n")])])])]),a._v(" "),t("li",[t("p",[a._v("查看镜像")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("sudo docker images\n")])])])]),a._v(" "),t("li",[t("p",[a._v("启动mysql容器")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("//切换root用户\nsu root \n\n# docker容器文件挂载与端口映射\ndocker run -p 3306:3306 --name mysql \\\n-v /mydata/mysql/log:/var/log/mysql \\\n-v /mydata/mysql/data:/var/lib/mysql \\\n-v /mydata/mysql/conf:/etc/mysql \\\n-e MYSQL_ROOT_PASSWORD=root \\\n-d mysql:5.7\n")])])]),t("p",[a._v("参数说明:")]),a._v(" "),t("p",[a._v("​\t-p 3306:3306 将容器的3306端口映射到主机的3306端口")]),a._v(" "),t("p",[a._v("​\t-v /mydata/mysql/log:/var/log/mysql \\ 将日志文件挂载到主机")]),a._v(" "),t("p",[a._v("​\t-v /mydata/mysql/data:/var/lib/mysql \\ 将数据文件挂载到主机")]),a._v(" "),t("p",[a._v("​\t-v /mydata/mysql/conf:/etc/mysql \\ 将配置文件挂载到主机")]),a._v(" "),t("p",[a._v("​\t-e MYSQL_ROOT_PASSWORD=root \\ 初始化root用户密码")])]),a._v(" "),t("li",[t("p",[a._v("进入交互模式")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("docker exec -it mysql /bin/bash\n")])])])]),a._v(" "),t("li",[t("p",[a._v("查看安装目录")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("whereis mysql\n")])])])]),a._v(" "),t("li",[t("p",[a._v("修改配置文件/mydata/mysql/conf/my.cnf")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("[client]\ndefault-character-set=utf8\n[mysql]\ndefault-character-set=utf8\n[mysqld]\ninit_connect='SET collation_connection = utf8_unicode_ci'\ninit_connect='SET NAMES utf8'\ncharacter-set-server=utf8\ncollation-server=utf8_unicode_ci\nskip-character-set-client-handshake\nskip-name-resolve\n")])])])]),a._v(" "),t("li",[t("p",[a._v("重启mysql")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("docker restart mysql\n")])])])]),a._v(" "),t("li",[t("p",[a._v("进入容器查看")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("[root@localhost conf]# docker exec -it mysql /bin/bash\nroot@3cee1a613904:/# cd /etc/mysql/\nroot@3cee1a613904:/etc/mysql# cat my.cnf\n[client]\ndefault-character-set=utf8\n[mysql]\ndefault-character-set=utf8\n[mysqld]\ninit_connect='SET collation_connection = utf8_unicode_ci'\ninit_connect='SET NAMES utf8'\ncharacter-set-server=utf8\ncollation-server=utf8_unicode_ci\nskip-character-set-client-handshake\nskip-name-resolve\nroot@3cee1a613904:/etc/mysql#\n")])])])])]),a._v(" "),t("h4",{attrs:{id:"docker中安装redis"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker中安装redis"}},[a._v("#")]),a._v(" docker中安装redis")]),a._v(" "),t("ol",[t("li",[t("p",[a._v("下载redis镜像")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("[root@localhost conf]# docker pull redis\nUsing default tag: latest\nlatest: Pulling from library/redis\n69692152171a: Already exists                                                 a4a46f2fd7e0: Pull complete                                                 bcdf6fddc3bd: Pull complete                                                 b7e9b50900cc: Pull complete                                                 5f3030c50d85: Pull complete                                                 63dae8e0776c: Pull complete                                                 Digest:sha256:365eddf64356169aa0cbfbeaf928eb80762de3cc364402e7653532bcec912973\nStatus: Downloaded newer image for redis:latest\ndocker.io/library/redis:latest\n")])])])]),a._v(" "),t("li",[t("p",[a._v("创建目录结构")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("[root@hadoop-104 ~]# mkdir -p /mydata/redis/conf\n[root@hadoop-104 ~]# touch /mydata/redis/conf/redis.conf\n")])])])]),a._v(" "),t("li",[t("p",[a._v("启动redis")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("docker run -p 6379:6379 --name redis -v /mydata/redis/data:/data \\\n-v /mydata/redis/conf/redis.conf:/etc/redis/redis.conf \\\n-d redis redis-server /etc/redis/redis.conf\n")])])])]),a._v(" "),t("li",[t("p",[a._v("进入redis客户端")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("docker exec -it redis redis-cli\n")])])])])]),a._v(" "),t("h4",{attrs:{id:"docker配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker配置"}},[a._v("#")]),a._v(" docker配置")]),a._v(" "),t("p",[a._v("设置mysql和redis跟随虚拟机重启")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("sudo docker update mysql --restart=always\nsudo docker update redis --restart=always\n")])])])])}),[],!1,null,null,null);e.default=r.exports}}]);